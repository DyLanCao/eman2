~~NOTOC~~

===== sxcryolo_train =====
crYOLO - training: Training of crYOLO, a deep learning high accuracy particle picking procedure.

\\
===== Usage =====

Usage in command line

  sxcryolo_train.py architecture particle_diameter training_dir annot_dir --input_size=input_size --num_patches=num_patches --overlap_patches=overlap_patches --train_times=train_times --weights_name=weights_name --batch_size=batch_size --learning_rate=learning_rate --np_epoch=np_epoch --object_scale=object_scale --no_object_scale=no_object_scale --coord_scale=coord_scale --valid_image_dir=valid_image_dir --valid_annot_dir=valid_annot_dir --warmup=warmup --gpu=gpu

\\
===== Typical usage =====

To train crYOLO for a specific dataset, one have to specify the path to training data in the config file.
Then the training typcial happens in two steps:

\\ __1. Warmup__:

  sxcryolo_train.py architecture particle_diameter

\\ __2. Actual training__:

  sxcryolo_train.py --conf=config_path --warmup=0 --gpu=0

\\
===== Input =====
=== Main Parameters ===
  ; architecture : Network architecture: Type of network that is trained.  (default YOLO)
  ; particle_diameter : Particle diameter [Pixel] : Particle diameter in pixel. This size will be used for as box size for picking. Should be as small as possible. (default 200)
  ; training_dir : Training image directory : Folder which contain all images. (default none)
  ; annot_dir : Annotation directory : Box or star files used for training. The should have the same name as the images. (default none)


\\
=== Advanced Parameters ===
  ; %%--%%input_size : Input image dimension [Pixel] : Dimension of the image used as input to network. (default 768)
  ; %%--%%num_patches : Number of patches : The number of patches (e.g 2x2) the image is divided and classified separately. (default 2)
  ; %%--%%overlap_patches: Patch overlap [Pixel]: The amount of overlap the patches will overlap (default 200)
  ; %%--%%train_times : Repeat images :  How often a images is augmented and repeadet in one epoch. (default 10)
  ; %%--%%weights_name: Weights name : Name of the model (default cryolo_model.h5)
  ; %%--%%batch_size : Batch size : How many patches are processed in parallel. (default 6)
  ; %%--%%learning_rate : Learning rate : Learning rate used during training. (default 0.0001)
  ; %%--%%np_epoch : Number of epochs : Maximum number of epochs. (default 100)
  ; %%--%%object_scale : Object loss scale : Loss scale for object. (default 5.0)
  ; %%--%%no_object_scale: Background loss scale: Loss scale for background. (default 1.0)
  ; %%--%%coord_scale: Coordinates loss scale: Loss scale for coordinates. (default 1.0)
  ; %%--%%valid_image_dir : Path to validation images : Images used (default none)
  ; %%--%%valid_annot_dir : Path to validation annotations : Path to the validation box files (default none)
  ; %%--%%warmup : Warm up epochs : Number of warmup epochs. (default 5)
  ; %%--%%gpu: GPUs : List of GPUs to use. (default 0)

\\
===== Output =====
It will write a .h5 file (default yolo_model.h5) into your project directory.

\\
=== List of Output Files ===
Write box and star files into the output directory

\\
===== Description =====
The training is divided into two parts. 1. Warmup: It prepares the network with a few epochs of training without actually estimating the size of the particle.
2. Actual training: The training will stop when the loss on the validation data stops to improve.

\\
==== Method ====
See the reference below.

\\
==== Time and Memory ===
Training needs a GPU with ~8GB memory. Training on 20 micrographs typicall needs ~20 minutes.


\\
==== Developer Notes ====
=== 2019/09/19 Thorsten Wagner ===
  * Initial creation of the document

\\
==== Reference ====
 https://doi.org/10.1101/356584

\\
==== Author / Maintainer ====
Thorsten Wagner

\\
==== Keywords ====
Category 1:: APPLICATIONS

\\
==== Files ====
sparx/bin/sxcryolo_train.py

\\
==== See also ====
[[pipeline:window:cryolo|crYOLO]]

\\
==== Maturity ====
Stable

\\
==== Bugs ====
None right now.

\\